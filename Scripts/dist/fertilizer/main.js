!function(e){"function"==typeof define&&define.amd?define("fertilizercalculator",[],e):FertilizerCalculator=e()}(function(){var e,n,t=function(e){var n=.1,t=[];return e.forEach(function(e,a){var r=2*(Math.random()-.5),i=e*n*r,u=e+i;0>u&&(u=0),t.push(u)}),t},a=function(e,n){var t=[],a=[];return e.forEach(function(e,a){var r=2*(Math.random()-.5);r>0||a>n.length-1?t.push(e):t.push(n[a])}),n.forEach(function(n,t){var r=2*(Math.random()-.5);r>0||t>e.length-1?a.push(n):a.push(e[t])}),[t,a]},r=function(t){var a=0;return e.forEach(function(e,r){var i=0;e.forEach(function(e,n){i+=e*t[n]}),a+=Math.abs(n[r]-i)}),a},i=function(e,n){var t=r(e),a=r(n);return t-a},u=function(e){var n=16;return e.sort(i),e.slice(0,n)},l=function(e,n){for(var r=0;n>r;r++){for(var i=e.length,l=0;i>l;l++)e.push(t(e[l]));e=u(e);for(var o=e.length,l=0;o>l;l+=2){var c=a(e[l],e[l+1]);e=e.concat(c)}}return e},o=function(){for(var t=[],a=e[0].length,r=0;a>r;r++){var i=0;e.forEach(function(e,t){if(e[r]>0){var a=n[t]/e[r];a>i&&(i=a)}}),t.push(i)}return t},c=function(t,a){e=t,n=a;var r=[o()];return r=l(r,250),r.sort(i),r[0]};return{Calculate:c}}),function(e){"function"==typeof define&&define.amd?define("fertilizerdata",[],e):FertilizerData=e()}(function(){return[{name:"Calcium Nitrate",formula:"Ca5(NO3)10NH4NO3(H2O)10"},{name:"Potassium Nitrate",formula:"KNO3"},{name:"Magnesium Sulfate",formula:"MgSO4(H2O)7"},{name:"Potassium Phosphate",formula:"KH2PO4"}]}),function(e){"function"==typeof define&&define.amd?define("molarmass",[],e):MolarMass=e()}(function(){var e={H:1.00794,He:4.0026,Li:6.941,Be:9.01218,B:10.811,C:12.011,N:14.0067,O:15.9994,F:18.9984,Ne:20.1797,Na:22.98977,Mg:24.305,Al:26.98154,Si:28.0855,P:30.97376,S:32.066,Cl:35.4527,Ar:39.948,K:39.0983,Ca:40.078,Sc:44.9559,Ti:47.88,V:50.9415,Cr:51.996,Mn:54.938,Fe:55.847,Co:58.9332,Ni:58.6934,Cu:63.546,Zn:65.39,Ga:69.723,Ge:72.61,As:74.9216,Se:78.96,Br:79.904,Kr:83.8,Rb:85.4678,Sr:87.62,Y:88.9059,Zr:91.224,Nb:92.9064,Mo:95.94,Tc:98,Ru:101.07,Rh:102.9055,Pd:106.42,Ag:107.868,Cd:112.41,In:114.82,Sn:118.71,Sb:121.757,Te:127.6,I:126.9045,Xe:131.29,Cs:132.9054,Ba:137.33,La:138.9055,Hf:178.49,Ta:180.9479,W:183.85,Re:186.207,Os:190.2,Ir:192.22,Pt:195.08,Au:196.9665,Hg:200.59,Tl:204.383,Pb:207.2,Bi:208.9804,Po:209,At:210,Rn:222,Fr:223,Ra:226.0254,Ac:227,Rf:261,Db:262,Sg:263,Bh:262,Hs:265,Mt:266,Uun:269,Uuu:272,Uub:277,Ce:140.12,Pr:140.9077,Nd:144.24,Pm:145,Sm:150.36,Eu:151.965,Gd:157.25,Tb:158.9253,Dy:162.5,Ho:164.9303,Er:167.26,Tm:168.9342,Yb:173.04,Lu:174.967,Th:232.0381,Pa:231.0359,U:238.029,Np:237.0482,Pu:244,Am:243,Cm:247,Bk:247,Cf:251,Es:252,Fm:257,Md:258,No:259,Lr:262},n=function(n){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZ",a="abcdefghijklmnopqrstuvwxyz",r="0123456789",i=new Array,u=0;i[0]=0;var l=0,o=0,c="",f=8,d=new Array;for(l=0;l<d.length;l++)d[l]=null;for(d[0]=new Array,l=0;l<d[0].length;l++)d[0][l]=0;for(l=0;""!=n.charAt(l);){for(-1==(t+a+r+"()").indexOf(n.charAt(l))&&l++;"("==n.charAt(l);){u++,l++,i[u]=0,d[u]=new Array;for(var m=0;l<d[u].length;m++)d[u][l]=0}if(")"==n.charAt(l))o=i[u],c="",u--;else if(-1!=t.indexOf(n.charAt(l))){for(c=n.charAt(l);-1!=a.indexOf(n.charAt(l+1))&&""!=n.charAt(l+1);)c+=n.charAt(++l);o=e[c];var v,s=o+"";v=-1!=s.indexOf(".")?s.substring(s.indexOf(".")+1,s.length).length:0,f=8==f||f>v?v:f}for(var h="";-1!=r.indexOf(n.charAt(l+1))&&""!=n.charAt(l+1);)h+=n.charAt(++l);if(""==h&&(h="1"),i[u]+=o*parseInt(h),""==c)for(var p in d[u+1]){var g=parseInt(d[u+1][p])*h;null==d[u][p]?d[u][p]=g:d[u][p]=g+parseInt(d[u][p])}else null==d[u][c]?d[u][c]=h:d[u][c]=parseInt(d[u][c])+parseInt(h);l++}var E={};return E.elmass=d[0],E.total=i[0],E},t=function(e){var t=n(e),a={};for(var r in t.elmass)"P"==r?a[r]=.44*t.elmass[r]/100:"K"==r?a[r]=.83*t.elmass[r]/100:a[r]=t.elmass[r]/100;return a},a=function(t){var a=n(t),r={};for(var i in a.elmass){var u=a.elmass[i]*e[i];r[i]=u/a.total}return r};return{Calculate:n,CalculateNPK:t,CalculateMM:a}}),function(e){"function"==typeof define&&define.amd?define("fertilizerui",["fertilizercalculator","fertilizerdata","molarmass"],e):FertilizerUI=e(FertilizerCalculator,FertilizerData,MolarMass)}(function(e,n,t){var a=function(e,n,t){for(var a=0;a<e.length;a++)n.call(t,e[a],a,e)},r=function(e){e.innerHTML='<div class="loading">Loading...</div>'},i=function(e){var n=e.querySelector(".loading");e.removeChild(n)},u=function(e,n,t){var a=document.createElement("div");a.className="row";var r=document.createElement("span");r.innerHTML=e+": ",r.className="cell";var i=document.createElement("span");return i.innerHTML=n.toLocaleString()+t,i.className="cell",a.appendChild(r),a.appendChild(i),a},l=function(e,n){var t={name:e,value:n},a=document.createElement("button");return a.className="fertilizer active",a.innerHTML=e,a.value=e,a.title="Remove "+e,a.dataset.fertilizer=JSON.stringify(t),a.addEventListener("click",function(){this.classList.toggle("active")}),a},o=function(){var e=document.getElementById("fertilizer-options"),n=document.getElementById("fertilizer-formula").value;if(n){var a=t.CalculateMM(n),r=l(n,a);e.appendChild(r)}},c=function(){var e=document.getElementById("fertilizer-options"),n=document.getElementById("npk-formula").value;if(n){var a=t.CalculateNPK(n),r=l(n,a);e.appendChild(r)}},f=function(e,n){var t=document.createElement("div");t.className="row goal";var a=document.createElement("label");a.className="cell element active",a.innerHTML=e,a.addEventListener("click",function(){this.classList.toggle("active")});var r=document.createElement("div");r.className="cell";var i=document.createElement("input");i.type="text",i.id="goal"+e,i.value=n,r.appendChild(i);var u=document.createElement("output");u.className="cell",u.id="output"+e;var l=document.createElement("output");return l.className="cell",l.id="error"+e,t.appendChild(a),t.appendChild(r),t.appendChild(u),t.appendChild(l),t},d=function(){var e=document.getElementById("fertilizer-goals"),n=document.getElementById("goal-element").value;if(n){var t=f(n,0);e.appendChild(t)}},m=function(){var e=[];return a(document.querySelectorAll(".fertilizer.active"),function(n){var t=JSON.parse(n.dataset.fertilizer);e.push(t)}),e},v=function(){var e=parseFloat(document.getElementById("volumeInput").value);return e},s=function(){var e=[];return a(document.querySelectorAll(".goal .element.active"),function(n){e.push({name:n.innerHTML})}),e},h=function(e,n){var t=[];return e.forEach(function(e,a){var r=[];n.forEach(function(n){r.push(n.value.hasOwnProperty(e.name)?n.value[e.name]:0)}),t.push(r)}),t},p=function(e,n){var t=[];return e.forEach(function(e,a,r){var i=parseFloat(document.getElementById("goal"+e.name).value)||0;r[a].value=i,t.push(i*n)}),t},g=function(e,n,t,r){a(document.querySelectorAll(".goal output"),function(e){e.innerHTML=0}),e.forEach(function(e,a){var i=0;t.forEach(function(t,a){i+=t*(n[a].value.hasOwnProperty(e.name)?n[a].value[e.name]:0)});var u=i/r;document.getElementById("output"+e.name).innerHTML=Math.round(u),document.getElementById("error"+e.name).innerHTML=Math.round(u-e.value)})},E=function(e,n){var t=document.getElementById("fertilizer-amounts");n.forEach(function(n,a){var r=u(e[a].name,Math.round(n),"mg");t.appendChild(r)})},y=function(e,n,t){var a=document.getElementById("fertilizer-amounts"),r=0;n.forEach(function(e,n){r+=e});var i=u("Total PPM",Math.round(r/t),"ppm");a.appendChild(i)},C=function(){var n=document.getElementById("fertilizer-amounts");r(n);var t=m(),a=v(),u=s(),l=h(u,t),o=p(u,a),c=e.Calculate(l,o);g(u,t,c,a),E(t,c),y(t,c,a),i(n)},I=function(){r(document.getElementById("fertilizer-amounts")),setTimeout(C,100)},M=function(){var e=document.getElementById("fertilizer-options");n.forEach(function(n){var a=t.CalculateMM(n.formula),r=l(n.name,a);e.appendChild(r)}),i(e)},B=function(){var e=document.getElementById("fertilizer-goals"),n=[{name:"N",value:211},{name:"P",value:46},{name:"K",value:263},{name:"Ca",value:132},{name:"Mg",value:20},{name:"S",value:13}];n.forEach(function(n){var t=f(n.name,n.value);e.appendChild(t)})},z=function(){document.getElementById("fertilizer-add").addEventListener("click",o),document.getElementById("fertilizer-formula").addEventListener("keyup",function(e){e.preventDefault(),13==e.keyCode&&o()}),document.getElementById("npk-add").addEventListener("click",c),document.getElementById("npk-formula").addEventListener("keyup",function(e){e.preventDefault(),13==e.keyCode&&c()}),document.getElementById("goal-add").addEventListener("click",d),document.getElementById("goal-element").addEventListener("keyup",function(e){e.preventDefault(),13==e.keyCode&&d()}),document.getElementById("fertilizer-submit").addEventListener("click",I)},N=function(){M(),B(),z()};return{Init:N}}),"function"==typeof define&&define.amd?require(["fertilizerui"],function(e){e.Init()}):FertilizerUI.Init(),define("main",function(){});
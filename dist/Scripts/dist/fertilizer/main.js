!function(a){"function"==typeof define&&define.amd?define("fertilizercalculator",[],a):FertilizerCalculator=a()}(function(){var a,e,t=function(a){var e=.1,t=[];return a.forEach(function(a,o){var n=2*(Math.random()-.5),r=a*e*n,m=a+r;0>m&&(m=0),t.push(m)}),t},o=function(a,e){var t=[],o=[];return a.forEach(function(a,o){var n=2*(Math.random()-.5);n>0||o>e.length-1?t.push(a):t.push(e[o])}),e.forEach(function(e,t){var n=2*(Math.random()-.5);n>0||t>a.length-1?o.push(e):o.push(a[t])}),[t,o]},n=function(t){var o=0;return a.forEach(function(a,n){var r=0;a.forEach(function(a,e){r+=a*t[e]}),o+=Math.abs(e[n]-r)}),o},r=function(a,e){var t=n(a),o=n(e);return t-o},m=function(a){var e=16;return a.sort(r),a.slice(0,e)},l=function(a,e){for(var n=0;e>n;n++){for(var r=a.length,l=0;r>l;l++)a.push(t(a[l]));a=m(a);for(var i=a.length,l=0;i>l;l+=2){var u=o(a[l],a[l+1]);a=a.concat(u)}}return a},i=function(){for(var t=[],o=a[0].length,n=0;o>n;n++){var r=1,m=0;a.forEach(function(a,e){a[n]>0&&a[n]<r&&(r=a[n],m=e)}),t.push(e[m]/r)}return t},u=function(t,o){a=t,e=o;var n=[i()];return n=l(n,250),n.sort(r),n[0]};return{Calculate:u}}),function(a){"function"==typeof define&&define.amd?define("fertilizerdata",[],a):FertilizerData=a()}(function(){return[{name:"Calcium Nitrate",formula:"Ca5(NO3)10NH4NO3(H2O)10"},{name:"Potassium Nitrate",formula:"KNO3"},{name:"Magnesium Sulfate",formula:"MgSO4(H2O)7"},{name:"Potassium Phosphate",formula:"KH2PO4"},{name:"Potassium Sulfate",formula:"K2SO4"},{name:"Ammonium Phosphate",formula:"(NH4)2HPO4"}]}),function(a){"function"==typeof define&&define.amd?define("molarmass",[],a):MolarMass=a()}(function(){var calculate=function(formula){var atom=new Array;atom.H=1.00794,atom.He=4.0026,atom.Li=6.941,atom.Be=9.01218,atom.B=10.811,atom.C=12.011,atom.N=14.0067,atom.O=15.9994,atom.F=18.9984,atom.Ne=20.1797,atom.Na=22.98977,atom.Mg=24.305,atom.Al=26.98154,atom.Si=28.0855,atom.P=30.97376,atom.S=32.066,atom.Cl=35.4527,atom.Ar=39.948,atom.K=39.0983,atom.Ca=40.078,atom.Sc=44.9559,atom.Ti=47.88,atom.V=50.9415,atom.Cr=51.996,atom.Mn=54.938,atom.Fe=55.847,atom.Co=58.9332,atom.Ni=58.6934,atom.Cu=63.546,atom.Zn=65.39,atom.Ga=69.723,atom.Ge=72.61,atom.As=74.9216,atom.Se=78.96,atom.Br=79.904,atom.Kr=83.8,atom.Rb=85.4678,atom.Sr=87.62,atom.Y=88.9059,atom.Zr=91.224,atom.Nb=92.9064,atom.Mo=95.94,atom.Tc=98,atom.Ru=101.07,atom.Rh=102.9055,atom.Pd=106.42,atom.Ag=107.868,atom.Cd=112.41,atom.In=114.82,atom.Sn=118.71,atom.Sb=121.757,atom.Te=127.6,atom.I=126.9045,atom.Xe=131.29,atom.Cs=132.9054,atom.Ba=137.33,atom.La=138.9055,atom.Hf=178.49,atom.Ta=180.9479,atom.W=183.85,atom.Re=186.207,atom.Os=190.2,atom.Ir=192.22,atom.Pt=195.08,atom.Au=196.9665,atom.Hg=200.59,atom.Tl=204.383,atom.Pb=207.2,atom.Bi=208.9804,atom.Po=209,atom.At=210,atom.Rn=222,atom.Fr=223,atom.Ra=226.0254,atom.Ac=227,atom.Rf=261,atom.Db=262,atom.Sg=263,atom.Bh=262,atom.Hs=265,atom.Mt=266,atom.Uun=269,atom.Uuu=272,atom.Uub=277,atom.Ce=140.12,atom.Pr=140.9077,atom.Nd=144.24,atom.Pm=145,atom.Sm=150.36,atom.Eu=151.965,atom.Gd=157.25,atom.Tb=158.9253,atom.Dy=162.5,atom.Ho=164.9303,atom.Er=167.26,atom.Tm=168.9342,atom.Yb=173.04,atom.Lu=174.967,atom.Th=232.0381,atom.Pa=231.0359,atom.U=238.029,atom.Np=237.0482,atom.Pu=244,atom.Am=243,atom.Cm=247,atom.Bk=247,atom.Cf=251,atom.Es=252,atom.Fm=257,atom.Md=258,atom.No=259,atom.Lr=262;var uppercase="ABCDEFGHIJKLMNOPQRSTUVWXYZ",lowercase="abcdefghijklmnopqrstuvwxyz",number="0123456789",total=new Array,level=0;total[0]=0;var i=0,mass=0,name="",percision=8,elmass=new Array;for(i=0;i<elmass.length;i++)elmass[i]=null;for(elmass[0]=new Array,i=0;i<elmass[0].length;i++)elmass[0][i]=0;for(i=0;""!=formula.charAt(i);){for(-1==(uppercase+lowercase+number+"()").indexOf(formula.charAt(i))&&i++;"("==formula.charAt(i);){level++,i++,total[level]=0,elmass[level]=new Array;for(var h=0;i<elmass[level].length;h++)elmass[level][i]=0}if(")"==formula.charAt(i))mass=total[level],name="",level--;else if(-1!=uppercase.indexOf(formula.charAt(i))){for(name=formula.charAt(i);-1!=lowercase.indexOf(formula.charAt(i+1))&&""!=formula.charAt(i+1);)name+=formula.charAt(++i);mass=atom[name];var massStr=mass+"",masspercis;masspercis=-1!=massStr.indexOf(".")?massStr.substring(massStr.indexOf(".")+1,massStr.length).length:0,percision=8==percision||percision>masspercis?masspercis:percision}for(var amount="";-1!=number.indexOf(formula.charAt(i+1))&&""!=formula.charAt(i+1);)amount+=formula.charAt(++i);if(""==amount&&(amount="1"),total[level]+=mass*parseInt(amount),""==name)for(var ele in elmass[level+1]){var totalnumber=parseInt(elmass[level+1][ele])*amount;null==elmass[level][ele]?elmass[level][ele]=totalnumber:elmass[level][ele]=totalnumber+parseInt(elmass[level][ele])}else null==elmass[level][name]?elmass[level][name]=amount:elmass[level][name]=parseInt(elmass[level][name])+parseInt(amount);i++}var retval={};for(var ele in elmass[0]){var eltotal=eval(elmass[0][ele]*atom[ele]);retval[ele]=eltotal/total[0]}return retval};return{Calculate:calculate}}),function(a){"function"==typeof define&&define.amd?define("fertilizerui",["fertilizercalculator","fertilizerdata","molarmass"],a):FertilizerUI=a(FertilizerCalculator,FertilizerData,MolarMass)}(function(a,e,t){var o=function(a,e,t){for(var o=0;o<a.length;o++)e.call(t,a[o],o,a)},n=function(a){var e=a.querySelector(".loading");a.removeChild(e)},r=function(a,e){var o={name:"",value:""};o.name=a,o.value=t.Calculate(e);var n=document.createElement("button");return n.className="fertilizer active",n.innerHTML=a,n.value=a,n.title="Remove "+a,n.dataset.fertilizer=JSON.stringify(o),n.addEventListener("click",function(){this.classList.toggle("active")}),n},m=function(){var a=document.getElementById("fertilizer-options"),e=document.getElementById("fertilizer-formula").value,t=r(e,e);a.appendChild(t)},l=function(a,e){var t=document.createElement("div");t.className="row";var o=document.createElement("label");o.className="cell",o.innerHTML=a;var n=document.createElement("div");n.className="cell";var r=document.createElement("input");r.type="text",r.id="goal"+a,r.value=e,n.appendChild(r);var m=document.createElement("output");m.className="cell",m.id="output"+a;var l=document.createElement("output");return l.className="cell",l.id="error"+a,t.appendChild(o),t.appendChild(n),t.appendChild(m),t.appendChild(l),t},i=function(a,e){var t=document.createElement("div");t.className="row";var o=document.createElement("span");o.innerHTML=a+": ",o.className="cell";var n=document.createElement("span");return n.innerHTML=e.toLocaleString()+"mg",n.className="cell",t.appendChild(o),t.appendChild(n),t},u=[{name:"N",value:211},{name:"P",value:46},{name:"K",value:263},{name:"Ca",value:132},{name:"Mg",value:20},{name:"S",value:13}],s=function(){var e=document.getElementById("fertilizer-amounts");e.innerHTML='<div class="loading">Loading...</div>';var t=[];o(document.querySelectorAll(".fertilizer.active"),function(a){var e=JSON.parse(a.dataset.fertilizer);t.push(e)});var r=parseFloat(document.getElementById("volumeInput").value),m=[];u.forEach(function(a,e,t){var o=parseFloat(document.getElementById("goal"+a.name).value);t[e].value=o,m.push(o*r)});var l=[];u.forEach(function(a,e){var o=[];t.forEach(function(e){o.push(e.value.hasOwnProperty(a.name)?e.value[a.name]:0)}),l.push(o)});var s=a.Calculate(l,m);s.forEach(function(a,o){var n=i(t[o].name,Math.round(a));e.appendChild(n)}),u.forEach(function(a,e){var o=0;s.forEach(function(e,n){o+=e*(t[n].value.hasOwnProperty(a.name)?t[n].value[a.name]:0)});var n=o/r;document.getElementById("output"+a.name).innerHTML=Math.round(n),document.getElementById("error"+a.name).innerHTML=Math.round(n-a.value)}),n(e)},c=function(){var a=document.getElementById("fertilizer-amounts");a.innerHTML='<div class="loading">Loading...</div>',setTimeout(s,100)},f=function(){var a=document.getElementById("fertilizer-options");e.forEach(function(e){var t=r(e.name,e.formula);a.appendChild(t)}),n(a);var t=document.getElementById("fertilizer-goals");u.forEach(function(a){var e=l(a.name,a.value);t.appendChild(e)});var o=document.getElementById("fertilizer-add");o.addEventListener("click",m);var i=document.getElementById("fertilizer-submit");i.addEventListener("click",c)};return{Init:f}}),"function"==typeof define&&define.amd?require(["fertilizerui"],function(a){a.Init()}):FertilizerUI.Init(),define("main",function(){});
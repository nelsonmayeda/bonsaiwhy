"use strict";(function(){function st(n){return n.valueOf()/a-.5+b}function e(n){return new Date((n+.5-b)*a)}function o(n){return st(n)-k}function d(i,r){return f(n(i)*t(s)-l(r)*n(s),t(i))}function v(i,r){return p(n(r)*t(s)+t(r)*n(s)*n(i))}function g(i,r,u){return f(n(i),t(i)*n(r)-l(u)*t(r))}function nt(i,r,u){return p(n(r)*n(u)+t(r)*t(u)*t(i))}function tt(n,t){return i*(280.16+360.9856235*n)-t}function it(n){return i*(357.5291+.98560028*n)}function rt(t){var r=i*(1.9148*n(t)+.02*n(2*t)+.0003*n(3*t)),f=i*102.9372;return t+r+f+u}function ut(n){var i=it(n),t=rt(i);return{dec:v(t,0),ra:d(t,0)}}function ht(n,t){return Math.round(n-y-t/(2*u))}function ft(n,t,i){return y+(n+t)/(2*u)+i}function et(t,i,r){return k+t+.0053*n(i)-.0069*n(2*r)}function ct(i,r,u){return w((n(i)-n(r)*n(u))/(t(r)*t(u)))}function lt(n,t,i,r,u,f,e){var o=ct(n,i,r),s=ft(o,t,u);return et(s,f,e)}function ot(r){var o=i*(218.316+13.176396*r),u=i*(134.963+13.064993*r),s=i*(93.272+13.22935*r),f=o+i*6.289*n(u),e=i*5.128*n(s),h=385001-20905*t(u);return{ra:d(f,e),dec:v(f,e),dist:h}}function c(n,t){return new Date(n.valueOf()+t*a/24)}var u=Math.PI,n=Math.sin,t=Math.cos,l=Math.tan,p=Math.asin,f=Math.atan2,w=Math.acos,i=u/180,a=864e5,b=2440588,k=2451545,s=i*23.4397,r={},h,y;r.getPosition=function(n,t,r){var h=i*-r,f=i*t,e=o(n),u=ut(e),s=tt(e,h)-u.ra;return{azimuth:g(s,f,u.dec),altitude:nt(s,f,u.dec)}};h=r.times=[[-.833,"sunrise","sunset"],[-.3,"sunriseEnd","sunsetStart"],[-6,"dawn","dusk"],[-12,"nauticalDawn","nauticalDusk"],[-18,"nightEnd","night"],[6,"goldenHourEnd","goldenHour"]];r.addTime=function(n,t,i){h.push([n,t,i])};y=.0009;r.getTimes=function(n,t,r){for(var c=i*-r,g=i*t,nt=o(n),w=ht(nt,c),b=ft(0,c,w),l=it(b),a=rt(l),tt=v(a,0),u=et(b,l,a),s,y,d,p={solarNoon:e(u),nadir:e(u-.5)},f=0,k=h.length;f<k;f+=1)s=h[f],y=lt(s[0]*i,c,g,tt,w,l,a),d=u-(y-u),p[s[1]]=e(d),p[s[2]]=e(y);return p};r.getMoonPosition=function(n,t,r){var c=i*-r,e=i*t,s=o(n),f=ot(s),h=tt(s,c)-f.ra,u=nt(h,e,f.dec);return u=u+i*.017/l(u+i*10.26/(u+i*5.1)),{azimuth:g(h,e,f.dec),altitude:u,distance:f.dist}};r.getMoonIllumination=function(i){var e=o(i),r=ut(e),u=ot(e),s=149598e3,h=w(n(r.dec)*n(u.dec)+t(r.dec)*t(u.dec)*t(r.ra-u.ra)),c=f(s*n(h),u.dist-s*t(h)),l=f(t(r.dec)*n(r.ra-u.ra),n(r.dec)*t(u.dec)-t(r.dec)*n(u.dec)*t(r.ra-u.ra));return{fraction:(1+t(c))/2,phase:.5+.5*c*(l<0?-1:1)/Math.PI,angle:l}};r.getMoonTimes=function(n,t,u,f){var s=new Date(n),d,a,g,nt,h,l,v,y,p,tt,it,w,o,b,rt,e,k;for(f?s.setUTCHours(0,0,0,0):s.setHours(0,0,0,0),d=.133*i,a=r.getMoonPosition(s,t,u).altitude-d,e=1;e<=24;e+=2){if(g=r.getMoonPosition(c(s,e),t,u).altitude-d,nt=r.getMoonPosition(c(s,e+1),t,u).altitude-d,v=(a+nt)/2-g,y=(nt-a)/2,p=-y/(2*v),tt=(v*p+y)*p+g,it=y*y-4*v*g,w=0,it>=0&&(rt=Math.sqrt(it)/(Math.abs(v)*2),o=p-rt,b=p+rt,Math.abs(o)<=1&&w++,Math.abs(b)<=1&&w++,o<-1&&(o=b)),w===1?a<0?h=e+o:l=e+o:w===2&&(h=e+(tt<0?b:o),l=e+(tt<0?o:b)),h&&l)break;a=nt}return k={},h&&(k.rise=c(s,h)),l&&(k.set=c(s,l)),h||l||(k[tt>0?"alwaysUp":"alwaysDown"]=!0),k};typeof define=="function"&&define.amd?define(r):typeof module!="undefined"?module.exports=r:window.SunCalc=r})();
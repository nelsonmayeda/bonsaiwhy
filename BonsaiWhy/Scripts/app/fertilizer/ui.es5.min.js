"use strict";(function(n){typeof define=="function"&&define.amd?define(["fertilizercalculator","fertilizerdata","molarmass"],n):FertilizerUI=n(FertilizerCalculator,FertilizerData,MolarMass)})(function(n,t,i){var r=function(n,t,i){for(var r=0;r<n.length;r++)t.call(i,n[r],r,n)},u=function(n){var t=n.querySelector(".loading");n.removeChild(t)},o=function(n,t){var i=document.createElement("div"),r,u;return i.className="row",r=document.createElement("span"),r.innerHTML=n+": ",r.className="cell",u=document.createElement("span"),u.innerHTML=t.toLocaleString()+"mg",u.className="cell",i.appendChild(r),i.appendChild(u),i},f=function(n,t){var u={name:"",value:""},r;return u.name=n,u.value=i.Calculate(t),r=document.createElement("button"),r.className="fertilizer active",r.innerHTML=n,r.value=n,r.title="Remove "+n,r.dataset.fertilizer=JSON.stringify(u),r.addEventListener("click",function(){this.classList.toggle("active")}),r},s=function(){var i=document.getElementById("fertilizer-options"),n=document.getElementById("fertilizer-formula").value,t;n&&(t=f(n,n),i.appendChild(t))},e=function(n,t){var i=document.createElement("div"),u,f,r,e,o;return i.className="row goal",u=document.createElement("label"),u.className="cell element",u.innerHTML=n,f=document.createElement("div"),f.className="cell",r=document.createElement("input"),r.type="text",r.id="goal"+n,r.value=t,f.appendChild(r),e=document.createElement("output"),e.className="cell",e.id="output"+n,o=document.createElement("output"),o.className="cell",o.id="error"+n,i.appendChild(u),i.appendChild(f),i.appendChild(e),i.appendChild(o),i},h=function(){var i=document.getElementById("fertilizer-goals"),n=document.getElementById("goal-element").value,t;n&&(t=e(n,0),i.appendChild(t))},c=function(){var n=[];return r(document.querySelectorAll(".goal .element"),function(t){n.push({name:t.innerHTML})}),n},l=function(){var i=document.getElementById("fertilizer-amounts"),t,e,s;i.innerHTML='<div class="loading">Loading...<\/div>';t=[];r(document.querySelectorAll(".fertilizer.active"),function(n){var i=JSON.parse(n.dataset.fertilizer);t.push(i)});var h=parseFloat(document.getElementById("volumeInput").value),l=[],f=c();f.forEach(function(n,t,i){var r=parseFloat(document.getElementById("goal"+n.name).value)||0;i[t].value=r;l.push(r*h)});e=[];f.forEach(function(n){var i=[];t.forEach(function(t){i.push(t.value.hasOwnProperty(n.name)?t.value[n.name]:0)});e.push(i)});s=n.Calculate(e,l);s.forEach(function(n,r){var u=o(t[r].name,Math.round(n));i.appendChild(u)});f.forEach(function(n){var r=0,i;s.forEach(function(i,u){r+=i*(t[u].value.hasOwnProperty(n.name)?t[u].value[n.name]:0)});i=r/h;document.getElementById("output"+n.name).innerHTML=Math.round(i);document.getElementById("error"+n.name).innerHTML=Math.round(i-n.value)});u(i)},a=function(){var n=document.getElementById("fertilizer-amounts");n.innerHTML='<div class="loading">Loading...<\/div>';setTimeout(l,100)},v=function(){var n=document.getElementById("fertilizer-options"),i,r,o,c,l;t.forEach(function(t){var i=f(t.name,t.formula);n.appendChild(i)});u(n);i=document.getElementById("fertilizer-goals");r=[{name:"N",value:211},{name:"P",value:46},{name:"K",value:263},{name:"Ca",value:132},{name:"Mg",value:20},{name:"S",value:13}];r.forEach(function(n){var t=e(n.name,n.value);i.appendChild(t)});o=document.getElementById("fertilizer-add");o.addEventListener("click",s);c=document.getElementById("goal-add");c.addEventListener("click",h);l=document.getElementById("fertilizer-submit");l.addEventListener("click",a)};return{Init:v}});
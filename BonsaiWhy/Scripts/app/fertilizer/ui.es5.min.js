"use strict";(function(n){typeof define=="function"&&define.amd?define(["fertilizercalculator","fertilizerdata","molarmass"],n):FertilizerUI=n(FertilizerCalculator,FertilizerData,MolarMass)})(function(n,t,i){var r=function(n,t,i){for(var r=0;r<n.length;r++)t.call(i,n[r],r,n)},u=function(n){n.innerHTML='<div class="loading">Loading...<\/div>'},f=function(n){var t=n.querySelector(".loading");n.removeChild(t)},s=function(n,t){var i=document.createElement("div"),r,u;return i.className="row",r=document.createElement("span"),r.innerHTML=n+": ",r.className="cell",u=document.createElement("span"),u.innerHTML=t.toLocaleString()+"mg",u.className="cell",i.appendChild(r),i.appendChild(u),i},e=function(n,t){var u={name:"",value:""},r;return u.name=n,u.value=i.Calculate(t),r=document.createElement("button"),r.className="fertilizer active",r.innerHTML=n,r.value=n,r.title="Remove "+n,r.dataset.fertilizer=JSON.stringify(u),r.addEventListener("click",function(){this.classList.toggle("active")}),r},h=function(){var i=document.getElementById("fertilizer-options"),n=document.getElementById("fertilizer-formula").value,t;n&&(t=e(n,n),i.appendChild(t))},o=function(n,t){var i=document.createElement("div"),r,f,u,e,o;return i.className="row goal",r=document.createElement("label"),r.className="cell element active",r.innerHTML=n,r.addEventListener("click",function(){this.classList.toggle("active")}),f=document.createElement("div"),f.className="cell",u=document.createElement("input"),u.type="text",u.id="goal"+n,u.value=t,f.appendChild(u),e=document.createElement("output"),e.className="cell",e.id="output"+n,o=document.createElement("output"),o.className="cell",o.id="error"+n,i.appendChild(r),i.appendChild(f),i.appendChild(e),i.appendChild(o),i},c=function(){var i=document.getElementById("fertilizer-goals"),n=document.getElementById("goal-element").value,t;n&&(t=o(n,0),i.appendChild(t))},l=function(){var n=[];return r(document.querySelectorAll(".fertilizer.active"),function(t){var i=JSON.parse(t.dataset.fertilizer);n.push(i)}),n},a=function(){return parseFloat(document.getElementById("volumeInput").value)},v=function(){var n=[];return r(document.querySelectorAll(".goal .element.active"),function(t){n.push({name:t.innerHTML})}),n},y=function(n,t){var i=[];return n.forEach(function(n){var r=[];t.forEach(function(t){r.push(t.value.hasOwnProperty(n.name)?t.value[n.name]:0)});i.push(r)}),i},p=function(n,t){var i=[];return n.forEach(function(n,r,u){var f=parseFloat(document.getElementById("goal"+n.name).value)||0;u[r].value=f;i.push(f*t)}),i},w=function(n,t,i,u){r(document.querySelectorAll(".goal output"),function(n){n.innerHTML=0});n.forEach(function(n){var f=0,r;i.forEach(function(i,r){f+=i*(t[r].value.hasOwnProperty(n.name)?t[r].value[n.name]:0)});r=f/u;document.getElementById("output"+n.name).innerHTML=Math.round(r);document.getElementById("error"+n.name).innerHTML=Math.round(r-n.value)})},b=function(n,t){var i=document.getElementById("fertilizer-amounts");t.forEach(function(t,r){var u=s(n[r].name,Math.round(t));i.appendChild(u)})},k=function(){var r=document.getElementById("fertilizer-amounts");u(r);var t=l(),e=a(),i=v(),s=y(i,t),h=p(i,e),o=n.Calculate(s,h);w(i,t,o,e);b(t,o);f(r)},d=function(){u(document.getElementById("fertilizer-amounts"));setTimeout(k,100)},g=function(){var n=document.getElementById("fertilizer-options"),i,r,u,s,l;t.forEach(function(t){var i=e(t.name,t.formula);n.appendChild(i)});f(n);i=document.getElementById("fertilizer-goals");r=[{name:"N",value:211},{name:"P",value:46},{name:"K",value:263},{name:"Ca",value:132},{name:"Mg",value:20},{name:"S",value:13}];r.forEach(function(n){var t=o(n.name,n.value);i.appendChild(t)});u=document.getElementById("fertilizer-add");u.addEventListener("click",h);s=document.getElementById("goal-add");s.addEventListener("click",c);l=document.getElementById("fertilizer-submit");l.addEventListener("click",d)};return{Init:g}});
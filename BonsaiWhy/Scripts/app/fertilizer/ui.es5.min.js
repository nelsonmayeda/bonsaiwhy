"use strict";(function(n){typeof define=="function"&&define.amd?define(["fertilizercalculator","fertilizerdata","molarmass"],n):FertilizerUI=n(FertilizerCalculator,FertilizerData,MolarMass)})(function(n,t,i){var e=function(n,t,i){for(var r=0;r<n.length;r++)t.call(i,n[r],r,n)},u=function(n){var t=n.querySelector(".loading");n.removeChild(t)},f=function(n,t){var u={name:"",value:""},r;return u.name=n,u.value=i.Calculate(t),r=document.createElement("button"),r.className="fertilizer active",r.innerHTML=n,r.value=n,r.title="Remove "+n,r.dataset.fertilizer=JSON.stringify(u),r.addEventListener("click",function(){this.classList.toggle("active")}),r},o=function(){var t=document.getElementById("fertilizer-options"),n=document.getElementById("fertilizer-formula").value,i=f(n,n);t.appendChild(i)},s=function(n,t){var i=document.createElement("div"),u,f,r,e,o;return i.className="row",u=document.createElement("label"),u.className="cell",u.innerHTML=n,f=document.createElement("div"),f.className="cell",r=document.createElement("input"),r.type="text",r.id="goal"+n,r.value=t,f.appendChild(r),e=document.createElement("output"),e.className="cell",e.id="output"+n,o=document.createElement("output"),o.className="cell",o.id="error"+n,i.appendChild(u),i.appendChild(f),i.appendChild(e),i.appendChild(o),i},h=function(n,t){var i=document.createElement("div"),r,u;return i.className="row",r=document.createElement("span"),r.innerHTML=n+": ",r.className="cell",u=document.createElement("span"),u.innerHTML=t.toLocaleString()+"mg",u.className="cell",i.appendChild(r),i.appendChild(u),i},r=[{name:"N",value:211},{name:"P",value:46},{name:"K",value:263},{name:"Ca",value:132},{name:"Mg",value:20},{name:"S",value:13}],c=function(){var i=document.getElementById("fertilizer-amounts"),t,f,o,s,c;i.innerHTML='<div class="loading">Loading...<\/div>';t=[];e(document.querySelectorAll(".fertilizer.active"),function(n){var i=JSON.parse(n.dataset.fertilizer);t.push(i)});f=parseFloat(document.getElementById("volumeInput").value);o=[];r.forEach(function(n,t,i){var r=parseFloat(document.getElementById("goal"+n.name).value);i[t].value=r;o.push(r*f)});s=[];r.forEach(function(n){var i=[];t.forEach(function(t){i.push(t.value.hasOwnProperty(n.name)?t.value[n.name]:0)});s.push(i)});c=n.Calculate(s,o);c.forEach(function(n,r){var u=h(t[r].name,Math.round(n));i.appendChild(u)});r.forEach(function(n){var r=0,i;c.forEach(function(i,u){r+=i*(t[u].value.hasOwnProperty(n.name)?t[u].value[n.name]:0)});i=r/f;document.getElementById("output"+n.name).innerHTML=Math.round(i);document.getElementById("error"+n.name).innerHTML=Math.round(i-n.value)});u(i)},l=function(){var n=document.getElementById("fertilizer-amounts");n.innerHTML='<div class="loading">Loading...<\/div>';setTimeout(c,100)},a=function(){var n=document.getElementById("fertilizer-options"),i,e,h;t.forEach(function(t){var i=f(t.name,t.formula);n.appendChild(i)});u(n);i=document.getElementById("fertilizer-goals");r.forEach(function(n){var t=s(n.name,n.value);i.appendChild(t)});e=document.getElementById("fertilizer-add");e.addEventListener("click",o);h=document.getElementById("fertilizer-submit");h.addEventListener("click",l)};return{Init:a}});
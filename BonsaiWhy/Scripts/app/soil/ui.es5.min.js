"use strict";(function(n){typeof define=="function"&&define.amd?define(["soilcalculator","soildata","pottingsoildata","soilchart","soilcolormaker"],n):SoilUI=n(SoilCalculator,SoilData,PottingSoilData,SoilChart,SoilColorMaker)})(function(n,t,i,r,u){var f=function(n,t,i){for(var r=0;r<n.length;r++)t.call(i,n[r],r,n)},h=function(n){var t=n.querySelector(".loading");n.removeChild(t)},c=function(n){var i=document.querySelector(".mix.active .substrate-container"),t=n.cloneNode(!0);t.title="Remove "+n.value;i.appendChild(t)},a=function(n){var t=o(n.target,"substrate");t&&(c(t),e())},v=function(n){var t=document.createElement("button");return t.className="substrate",t.innerHTML=n.label,t.value=n.label,t.title="Add "+n.label,t.dataset.substrate=JSON.stringify(n),t},y=function(){var i=document.getElementById("source"),n;i.addEventListener("click",a);n=document.getElementById("substrate-container");n&&t.forEach(function(t){var i=v(t);n.appendChild(i)});h(n)},e=function(){var u=[],s=document.querySelectorAll(".mix.active .substrate"),t,e,o,i;f(s,function(n){u.push(JSON.parse(n.dataset.substrate))});t=-1;e=document.querySelectorAll(".mix");f(e,function(n,i){n.classList.contains("active")&&(t=i)});t>=0&&(o=n.calculate(u),i=[],o.forEach(function(n){i.push(Math.round(1e3*n)/1e3)}),r.UpdateDataset(t,i))},o=function(n,t){var r=!0,i,u;n:while(r){if(i=n,u=t,r=!1,i){if(i.classList.contains(u))return i;n=i.parentElement;t=u;r=!0;continue n}return null}},p=function(n){var i=o(n.target,"mix"),t;i&&(l(i),t=o(n.target,"substrate"),t&&(t.parentElement.removeChild(t),e()))},l=function(n){var t=document.querySelectorAll(".mix");f(t,function(n){n.classList.remove("active")});n.classList.add("active")},w=function(n,t){var f=document.querySelectorAll(".mix"),e=f.length+1,i=document.createElement("div"),r,u;return i.className="mix active",r=document.createElement("div"),r.className="label",r.appendChild(document.createTextNode(n)),u=document.createElement("div"),u.className="substrate-container",i.appendChild(r),i.appendChild(u),i.style.backgroundColor=t,i},s=function(){var e=document.querySelectorAll(".mix"),o=e.length+1,n="Mix "+o,t=u.GetNewColor(1),i=document.getElementById("mixes-container"),f=w(n,t);i.insertBefore(f,i.firstChild);l(f);r.NewDataset(n,t)},b=function(n){s();n.forEach(function(n){var t=document.querySelector(".substrate[value="+n+"]");c(t)});e()},k=function(){var i=document.getElementById("destination"),n,t;i.addEventListener("click",p);n=document.getElementById("btn-add");n.addEventListener("click",s);b(["Akadama","Pumice","Lava"]);s();t=document.getElementById("mixes-container");h(t)},d=function(){i.forEach(function(n){var i=u.GetNewColor(1),t;r.NewDataset(n.label,i);t=[];n.data.forEach(function(n){t.push(n.water)});r.UpdateDataset(0,t)})},g=function(){var n=document.getElementById("chart1").getContext("2d");r.Init(n,"Water ratio by volume - %",["0hr","1hr","2hr","3hr","6hr","12hr","24hr","48hr","72hr"]);d()},nt=function(){g();y();k()};return{Init:nt}});
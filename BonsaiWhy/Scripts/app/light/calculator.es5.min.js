"use strict";(function(n){typeof define=="function"&&define.amd?define([],n):LightCalculator=n()})(function(){var n=function(n,t,i,r){var f=Math.PI/2-n,u=Math.cos(f)*Math.cos(i)+Math.sin(f)*Math.sin(i)*Math.cos(r-t);return u=Math.min(Math.max(u,-1),1),Math.acos(u)},i=function(t,i,r,u,f){var e=n(t,i,r,u),o=f.direct*Math.cos(e);return Math.max(0,o)},r=function(n,t,i,r,u){var f=.5*.2*u.global*(1-Math.cos(i));return Math.max(0,f)},u=function(n){return n<1.056?[-.011,.748,-.08,-.048,.073,-.024]:n<1.253?[-.038,1.115,-.109,-.023,.106,-.037]:n<1.586?[.166,.909,-.179,.062,-.021,-.05]:n<2.134?[.419,.646,-.262,.14,-.167,-.042]:n<3.23?[.71,.025,-.29,.243,-.511,-.004]:n<5.98?[.857,-.37,-.279,.267,-.792,.076]:n<10.08?[.734,-.073,-.228,.231,-1.18,.199]:[.421,-.661,.097,.119,-2.125,.446]},f=function(t,i,r,f,e){var c=n(t,i,r,f),s=Math.PI/2-t,o=u(e.cover),h=o[0]+o[1]*e.extraterrestrial+o[2]*s,l=o[3]+o[4]*e.extraterrestrial+o[5]*s,a=Math.max(0,Math.cos(c)),v=Math.max(.087,Math.cos(s)),y=e.diffuse*(.5*(1-h)*(1+Math.cos(r))+h*a/v+l*Math.sin(r));return Math.max(0,y)},t=function(n,t,u,e,o){var s=i(n,t,u,e,o),h=r(n,t,u,e,o),c=f(n,t,u,e,o);return{direct:s,diffuse:h+c}},e=function(n,i,r,u,f){for(var s,h,e=0,o=0;o<=Math.PI/2;o+=.1)s=t(n,i,o,u,f),h=s.direct+s.diffuse,h>e&&(e=h);return e},o=function(n,i,r,u,f){for(var l,a,e,h,c,o=0,s=0;s<=Math.PI/2;s+=.1)for(l=u-Math.PI/2,a=u+Math.PI/2,e=l;e<=a;e+=.1)h=t(n,i,s,e,f),c=h.direct+h.diffuse/2,c>o&&(o=c);return o},s=function(t,i,r,u,f){var p=Math.exp(-3.18*.032),o=1,s=1.5,d=Math.asin(o*Math.sin(t)/s),g=Math.asin(o*Math.sin(i)/s),e=Math.PI/3,h=Math.asin(o*Math.sin(e)/s),c=h-e,l=h+e,w=1-.5*(Math.sin(c)*Math.sin(c)/(Math.sin(l)*Math.sin(l))+Math.tan(c)*Math.tan(c)/(Math.tan(l)*Math.tan(l))),b=n(t,i,r,u),rt=Math.asin(o*Math.sin(b)/s),a=h-e,v=h+e,k=1-.5*(Math.sin(a)*Math.sin(a)/(Math.sin(v)*Math.sin(v))+Math.tan(a)*Math.tan(a)/(Math.tan(v)*Math.tan(v)));Math.cos(b)<0&&(k=0);var nt=p*k*f.direct,tt=p*w*f.global,it=p*w*f.diffuse,y=JSON.parse(JSON.stringify(f));return y.direct=nt,y.global=tt,y.diffuse=it,{solaraltitude:d,solarazimuth:g,data:y}},h=function(n,t,i,r,u){var f=s(n,t,i,r,u);return o(f.solaraltitude,f.solarazimuth,i,r,f.data)},c=function(n,t,i,r,u){return e(n,t,i,r,u)};return{getIncidence:n,getRadTotal:t,calculateInside:h,calculateOutside:c}});